#!/bin/bash
# Nord Theme Optimized - Behebt die identifizierten Design-Probleme
# Implementiert semantische Farben und kontextuelle Themes

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OPTIMIERTE NORD THEME IMPLEMENTATION
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Erweiterte Dialog-Konfiguration mit semantischen Farben
generate_optimized_nord_theme() {
    cat << 'EOF'
# ExaPG Optimized Nord Dark Theme v4.0 - SEMANTIC COLORS ACTIVE
# Behebt monotone Farbgebung und implementiert visuelle Hierarchie

# Dialog-Verhalten
aspect = 0
separate_widget = ""
tab_len = 0
visit_items = ON
use_shadow = ON
use_colors = ON

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OPTIMIERTE NORD FARBSTRATEGIE - AKTIVE SEMANTIK
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”µ CYAN (4) - PrimÃ¤re Aktionen, wichtige Navigation
# ğŸ”· BLUE (6) - Strukturelemente, Management
# ğŸŸ¢ GREEN (2) - Erfolg, Status, Gesundheit
# ğŸŸ¡ YELLOW (3) - Warnungen, Aufmerksamkeit, Anpassungen
# ğŸ”´ RED (1) - Fehler, kritische Aktionen
# ğŸŸ£ MAGENTA (5) - Info, Profile, Spezialfunktionen
# âšª WHITE (7) - Standard Text, Information
# âš« BLACK (0) - Hintergrund, Struktur
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# BASIS LAYOUT - Optimierter Nord Look
screen_color = (WHITE,BLACK,OFF)
shadow_color = (BLACK,BLACK,ON)
dialog_color = (WHITE,BLACK,OFF)

# TITEL & BORDERS - Hierarchische Frost-Farben mit mehr Kontrast
title_color = (CYAN,BLACK,ON)           # ğŸ”µ PrimÃ¤re Aufmerksamkeit
border_color = (BLUE,BLACK,ON)          # ğŸ”· Strukturelle Elemente
border2_color = (CYAN,BLACK,ON)         # ğŸ”µ VerstÃ¤rkte SekundÃ¤re Borders

# BUTTONS - Optimierte semantische Farbkodierung
button_active_color = (BLACK,GREEN,ON)      # ğŸŸ¢ GrÃ¼n fÃ¼r positive Aktionen (OK)
button_inactive_color = (CYAN,BLACK,OFF)    # ğŸ”µ Cyan fÃ¼r neutrale Buttons
button_key_active_color = (BLACK,YELLOW,ON) # ğŸŸ¡ Gelb fÃ¼r Keyboard-Shortcuts
button_key_inactive_color = (YELLOW,BLACK,ON) # ğŸŸ¡ VerstÃ¤rkte Shortcuts
button_label_active_color = (BLACK,GREEN,ON)    # ğŸŸ¢ Konsistent mit Button
button_label_inactive_color = (CYAN,BLACK,OFF)  # ğŸ”µ Cyan statt langweiliges WeiÃŸ

# MENU SYSTEM - Optimierte Hierarchie mit verstÃ¤rkten Farben
menubox_color = (WHITE,BLACK,OFF)           # âšª Standard Hintergrund
menubox_border_color = (BLUE,BLACK,ON)      # ğŸ”· Strukturelle Begrenzung
menubox_border2_color = (CYAN,BLACK,ON)     # ğŸ”µ VerstÃ¤rkte Akzent-Border
item_color = (WHITE,BLACK,OFF)              # âšª Standard MenÃ¼-Items
item_selected_color = (BLACK,CYAN,ON)       # ğŸ”µ VerstÃ¤rkte PrimÃ¤re Selektion

# TAG SYSTEM - VerstÃ¤rkte Aufmerksamkeits-Farben
tag_color = (YELLOW,BLACK,ON)               # ğŸŸ¡ AuffÃ¤llige Tags
tag_selected_color = (BLACK,YELLOW,ON)      # ğŸŸ¡ Invertierte Selektion
tag_key_color = (YELLOW,BLACK,ON)           # ğŸŸ¡ Konsistente Shortcuts
tag_key_selected_color = (BLACK,YELLOW,ON)  # ğŸŸ¡ Aktive Shortcuts

# EINGABEFELDER - VerstÃ¤rkte Input-Ã„sthetik
inputbox_color = (WHITE,BLACK,OFF)          # âšª Standard Input
inputbox_border_color = (CYAN,BLACK,ON)     # ğŸ”µ VerstÃ¤rkte Input-Borders
inputbox_border2_color = (BLUE,BLACK,ON)    # ğŸ”· SekundÃ¤re Struktur
form_active_text_color = (BLACK,CYAN,ON)    # ğŸ”µ Aktive Eingabe
form_text_color = (WHITE,BLACK,OFF)         # âšª Standard Text
form_item_readonly_color = (BLUE,BLACK,ON)  # ğŸ”· VerstÃ¤rkte Readonly-Felder

# CHECKBOXEN & AUSWAHL - VerstÃ¤rktes semantisches GrÃ¼n
check_color = (WHITE,BLACK,OFF)             # âšª Unselected
check_selected_color = (BLACK,GREEN,ON)     # ğŸŸ¢ VerstÃ¤rktes Erfolg-GrÃ¼n

# PROGRESS & GAUGE - VerstÃ¤rkte Fortschrittsanzeige
gauge_color = (BLACK,CYAN,ON)               # ğŸ”µ PrimÃ¤rer Fortschritt

# SUCHFUNKTION - VerstÃ¤rkte Such-UI
searchbox_color = (WHITE,BLACK,OFF)         # âšª Such-Hintergrund
searchbox_title_color = (MAGENTA,BLACK,ON)  # ğŸŸ£ Info-Magenta fÃ¼r Such-Titel
searchbox_border_color = (CYAN,BLACK,ON)    # ğŸ”µ VerstÃ¤rkte Such-Border
searchbox_border2_color = (BLUE,BLACK,ON)   # ğŸ”· SekundÃ¤re Struktur

# NAVIGATION - VerstÃ¤rkte Bewegungs-GrÃ¼n
position_indicator_color = (GREEN,BLACK,ON) # ğŸŸ¢ Positions-Indikator
uarrow_color = (GREEN,BLACK,ON)             # ğŸŸ¢ AufwÃ¤rts-Pfeil
darrow_color = (GREEN,BLACK,ON)             # ğŸŸ¢ AbwÃ¤rts-Pfeil

# HILFE & SEKUNDÃ„RE ELEMENTE - VerstÃ¤rkte Info-Magenta
itemhelp_color = (MAGENTA,BLACK,ON)         # ğŸŸ£ VerstÃ¤rkte Hilfe-Text

# ERWEITERTE SEMANTISCHE ELEMENTE - Optimiert
week_number_color = (MAGENTA,BLACK,ON)      # ğŸŸ£ Wochen-Info
weekday_color = (BLUE,BLACK,ON)             # ğŸ”· Wochentage
day_color = (WHITE,BLACK,OFF)               # âšª Standard Tage
day_selected_color = (BLACK,CYAN,ON)        # ğŸ”µ AusgewÃ¤hlter Tag
month_color = (CYAN,BLACK,ON)               # ğŸ”µ Monat-Header
year_color = (YELLOW,BLACK,ON)              # ğŸŸ¡ Jahr-Anzeige

# Text-Viewer - Optimiert fÃ¼r bessere Lesbarkeit
textbox_color = (WHITE,BLACK,OFF)           # âšª Text-Hintergrund
textbox_border_color = (BLUE,BLACK,ON)      # ğŸ”· Text-Border
textbox_border2_color = (CYAN,BLACK,ON)     # ğŸ”µ VerstÃ¤rkte Text-Border

EOF
}

# Kontextuelle Theme-Anpassungen
apply_contextual_colors() {
    local context="$1"
    local temp_dialogrc="/tmp/contextual_dialogrc_$$"
    
    case "$context" in
        "status")
            # GrÃ¼n-dominiertes Theme fÃ¼r Status-Anzeigen
            generate_optimized_nord_theme > "$temp_dialogrc"
            cat >> "$temp_dialogrc" << 'EOF'
# STATUS CONTEXT OVERRIDES
title_color = (GREEN,BLACK,ON)
border_color = (GREEN,BLACK,ON)
button_active_color = (BLACK,GREEN,ON)
EOF
            ;;
        "warning")
            # Gelb-akzentuiertes Theme fÃ¼r Warnungen
            generate_optimized_nord_theme > "$temp_dialogrc"
            cat >> "$temp_dialogrc" << 'EOF'
# WARNING CONTEXT OVERRIDES
title_color = (YELLOW,BLACK,ON)
border_color = (YELLOW,BLACK,ON)
button_active_color = (BLACK,YELLOW,ON)
EOF
            ;;
        "error")
            # Rot-akzentuiertes Theme fÃ¼r Fehler
            generate_optimized_nord_theme > "$temp_dialogrc"
            cat >> "$temp_dialogrc" << 'EOF'
# ERROR CONTEXT OVERRIDES
title_color = (RED,BLACK,ON)
border_color = (RED,BLACK,ON)
button_active_color = (BLACK,RED,ON)
EOF
            ;;
        "success")
            # GrÃ¼n-akzentuiertes Theme fÃ¼r Erfolg
            generate_optimized_nord_theme > "$temp_dialogrc"
            cat >> "$temp_dialogrc" << 'EOF'
# SUCCESS CONTEXT OVERRIDES
title_color = (GREEN,BLACK,ON)
border_color = (GREEN,BLACK,ON)
button_active_color = (BLACK,GREEN,ON)
EOF
            ;;
        *)
            # Standard optimiertes Theme
            generate_optimized_nord_theme > "$temp_dialogrc"
            ;;
    esac
    
    export DIALOGRC="$temp_dialogrc"
    export DIALOGOPTS="--colors --no-shadow --ascii-lines"
}

# Optimierte Terminal-Farbsetzung
apply_optimized_terminal_colors() {
    # VerstÃ¤rkte Nord-Farben fÃ¼r bessere Sichtbarkeit
    if [ "$(tput colors 2>/dev/null || echo 8)" -ge 256 ]; then
        # Terminal-Hintergrund und -Vordergrund
        printf '\033]11;#2E3440\007'  # Nord0 Background
        printf '\033]10;#ECEFF4\007'  # Nord6 Foreground (heller fÃ¼r besseren Kontrast)
        printf '\033]12;#88C0D0\007'  # Nord8 Cursor
        
        # Optimierte 16-Farben-Palette
        printf '\033]4;0;#2E3440\007'   # black -> nord0 (dunkler)
        printf '\033]4;1;#BF616A\007'   # red -> nord11
        printf '\033]4;2;#A3BE8C\007'   # green -> nord14
        printf '\033]4;3;#EBCB8B\007'   # yellow -> nord13
        printf '\033]4;4;#5E81AC\007'   # blue -> nord10
        printf '\033]4;5;#B48EAD\007'   # magenta -> nord15
        printf '\033]4;6;#88C0D0\007'   # cyan -> nord8
        printf '\033]4;7;#ECEFF4\007'   # white -> nord6 (heller)
        printf '\033]4;8;#4C566A\007'   # bright black -> nord3
        printf '\033]4;9;#D08770\007'   # bright red -> nord12
        printf '\033]4;10;#A3BE8C\007'  # bright green -> nord14
        printf '\033]4;11;#EBCB8B\007'  # bright yellow -> nord13
        printf '\033]4;12;#81A1C1\007'  # bright blue -> nord9
        printf '\033]4;13;#B48EAD\007'  # bright magenta -> nord15
        printf '\033]4;14;#8FBCBB\007'  # bright cyan -> nord7
        printf '\033]4;15;#ECEFF4\007'  # bright white -> nord6
    fi
}

# Semantische Dialog-Funktionen mit optimierten Farben
show_optimized_dialog() {
    local type="$1"
    local title="$2"
    local message="$3"
    
    apply_contextual_colors "$type"
    
    case "$type" in
        "success")
            dialog --colors \
                   --backtitle "âœ… Success" \
                   --title "[ $title ]" \
                   --msgbox "$message" 8 50
            ;;
        "warning")
            dialog --colors \
                   --backtitle "âš ï¸ Warning" \
                   --title "[ $title ]" \
                   --msgbox "$message" 8 50
            ;;
        "error")
            dialog --colors \
                   --backtitle "âŒ Error" \
                   --title "[ $title ]" \
                   --msgbox "$message" 8 50
            ;;
        "info")
            apply_contextual_colors "default"
            dialog --colors \
                   --backtitle "â„¹ï¸ Information" \
                   --title "[ $title ]" \
                   --msgbox "$message" 8 50
            ;;
    esac
    
    rm -f "$DIALOGRC"
}

# Optimiertes HauptmenÃ¼ mit semantischen Farben
show_optimized_main_menu() {
    apply_contextual_colors "default"
    
    # Verwende Dialog-Farbcodes fÃ¼r semantische MenÃ¼-Items
    dialog --colors \
           --backtitle "ExaPG v2.0.0 - Optimized Nord Theme" \
           --title "[ ExaPG Management Console ]" \
           --cancel-label "Exit" \
           --menu "Select an option:" 16 70 6 \
           "1" "\Z4ğŸ”§ Installation Wizard\Zn" \
           "2" "\Z6âš™ï¸ Configuration Management\Zn" \
           "3" "\Z2ğŸ“Š System Status & Services\Zn" \
           "4" "\Z5ğŸ‘¤ Profile Management\Zn" \
           "5" "\Z3ğŸ¨ Theme Settings\Zn" \
           "6" "\Z7â„¹ï¸ System Information\Zn"
}

# Optimierte Status-Anzeige mit dynamischen Farben
show_optimized_status() {
    apply_contextual_colors "status"
    
    # Sammle System-Informationen (vereinfacht fÃ¼r KompatibilitÃ¤t)
    local cpu_usage="26.6"
    local mem_usage="26.3"
    local disk_usage="28"
    
    # Dynamische Farbkodierung basierend auf Werten
    local cpu_color="\Z2"  # GrÃ¼n
    local mem_color="\Z2"  # GrÃ¼n
    local disk_color="\Z2" # GrÃ¼n
    
    # Farben basierend auf Schwellenwerten anpassen (vereinfacht)
    if [ "${cpu_usage%.*}" -gt 70 ]; then cpu_color="\Z1"; fi  # Rot
    if [ "${cpu_usage%.*}" -gt 50 ]; then cpu_color="\Z3"; fi  # Gelb
    
    if [ "${mem_usage%.*}" -gt 80 ]; then mem_color="\Z1"; fi  # Rot
    if [ "${mem_usage%.*}" -gt 60 ]; then mem_color="\Z3"; fi  # Gelb
    
    if [ "$disk_usage" -gt 80 ]; then disk_color="\Z1"; fi  # Rot
    if [ "$disk_usage" -gt 60 ]; then disk_color="\Z3"; fi  # Gelb
    
    local status_text="SYSTEM RESOURCE OVERVIEW
==========================================

${cpu_color}CPU USAGE: ${cpu_usage}%\Zn
${mem_color}MEMORY USAGE: ${mem_usage}%\Zn
${disk_color}DISK USAGE: ${disk_usage}%\Zn
LOAD AVERAGE: 1.07, 1.11, 1.04

DOCKER CONTAINERS:
\Z2exapg-coordinator Up 2 days (healthy)\Zn

==========================================
Press OK to continue..."

    dialog --colors \
           --backtitle "ExaPG > System Status > Resources" \
           --title "[ System Status ]" \
           --msgbox "$status_text" 16 50
    
    rm -f "$DIALOGRC"
}

# Demo der optimierten Themes
demo_optimized_themes() {
    echo "ğŸ¨ Optimized Nord Theme Demo"
    echo "============================="
    
    # Terminal-Farben optimiert setzen
    apply_optimized_terminal_colors
    
    echo "1. Standard optimiertes MenÃ¼..."
    sleep 1
    show_optimized_main_menu
    
    echo "2. Optimierte Status-Anzeige..."
    sleep 1
    show_optimized_status
    
    echo "3. Semantische Dialog-Typen..."
    sleep 1
    
    show_optimized_dialog "success" "Operation Successful" "âœ… Die Operation wurde erfolgreich abgeschlossen!\n\nAlle Ã„nderungen wurden gespeichert."
    
    show_optimized_dialog "warning" "Attention Required" "âš ï¸ Achtung: Hohe CPU-Auslastung erkannt!\n\nBitte Ã¼berprÃ¼fen Sie die laufenden Prozesse."
    
    show_optimized_dialog "error" "Critical Error" "âŒ Kritischer Fehler aufgetreten!\n\nDie Datenbankverbindung konnte nicht hergestellt werden."
    
    show_optimized_dialog "info" "Information" "â„¹ï¸ System-Information\n\nExaPG lÃ¤uft stabil mit optimierten Nord-Farben."
    
    clear
    echo "âœ… Optimized Nord Theme Demo abgeschlossen!"
    echo
    echo "Verbesserungen:"
    echo "ğŸ”µ CYAN - VerstÃ¤rkte primÃ¤re Navigation"
    echo "ğŸ”· BLUE - Klarere strukturelle Elemente"
    echo "ğŸŸ¢ GREEN - Dynamische Status-Farben"
    echo "ğŸŸ¡ YELLOW - Aufmerksamkeits-Optimierung"
    echo "ğŸ”´ RED - Kritische Aktionen hervorgehoben"
    echo "ğŸŸ£ MAGENTA - Verbesserte Info-Darstellung"
}

# Integration in ExaPG
apply_optimized_theme_to_exapg() {
    echo "ğŸ”§ Applying Optimized Nord Theme to ExaPG..."
    
    # Backup erstellen
    if [ ! -f scripts/cli/terminal-ui.sh.optimized-backup ]; then
        cp scripts/cli/terminal-ui.sh scripts/cli/terminal-ui.sh.optimized-backup
        echo "ğŸ“ Optimized backup created"
    fi
    
    # Optimierte Theme-Funktion hinzufÃ¼gen
    cat >> scripts/cli/terminal-ui.sh << 'EOF'

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# OPTIMIZED NORD THEME INTEGRATION - Enhanced semantic colors
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Optimized Nord Theme Generator
generate_optimized_nord_theme() {
EOF
    generate_optimized_nord_theme | sed 's/^/    /' >> scripts/cli/terminal-ui.sh
    cat >> scripts/cli/terminal-ui.sh << 'EOF'
}

# Enhanced color application
apply_optimized_terminal_colors() {
EOF
    declare -f apply_optimized_terminal_colors | sed '1,2d;$d' | sed 's/^/    /' >> scripts/cli/terminal-ui.sh
    cat >> scripts/cli/terminal-ui.sh << 'EOF'
}

# Contextual color application
apply_contextual_colors() {
EOF
    declare -f apply_contextual_colors | sed '1,2d;$d' | sed 's/^/    /' >> scripts/cli/terminal-ui.sh
    cat >> scripts/cli/terminal-ui.sh << 'EOF'
}
EOF
    
    # Bestehende Funktionen optimieren
    sed -i 's/generate_modern_nord_dark_theme/generate_optimized_nord_theme/g' scripts/cli/terminal-ui.sh
    sed -i 's/apply_nord_terminal_colors/apply_optimized_terminal_colors/g' scripts/cli/terminal-ui.sh
    
    echo "âœ… Optimized Nord Theme successfully integrated!"
    echo "   Enhanced features:"
    echo "   â€¢ VerstÃ¤rkte semantische Farben"
    echo "   â€¢ Kontextuelle Theme-Anpassung"
    echo "   â€¢ Dynamische Status-Farbkodierung"
    echo "   â€¢ Verbesserte Benutzerfreundlichkeit"
}

# HauptmenÃ¼
main() {
    clear
    echo -e "\033[38;2;136;192;208mâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\033[0m"
    echo -e "\033[38;2;136;192;208mâ•‘\033[0m                                                              \033[38;2;136;192;208mâ•‘\033[0m"
    echo -e "\033[38;2;136;192;208mâ•‘\033[0m  \033[38;2;235;203;139mğŸ¨ Optimized Nord Theme fÃ¼r ExaPG\033[0m                       \033[38;2;136;192;208mâ•‘\033[0m"
    echo -e "\033[38;2;136;192;208mâ•‘\033[0m  \033[38;2;229;233;240mBehebt monotone Farben & verstÃ¤rkt Semantik\033[0m             \033[38;2;136;192;208mâ•‘\033[0m"
    echo -e "\033[38;2;136;192;208mâ•‘\033[0m                                                              \033[38;2;136;192;208mâ•‘\033[0m"
    echo -e "\033[38;2;136;192;208mâ•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\033[0m"
    echo
    echo -e "\033[38;2;163;190;140m1)\033[0m \033[38;2;229;233;240mDemo - Zeige optimierte Themes\033[0m"
    echo -e "\033[38;2;163;190;140m2)\033[0m \033[38;2;229;233;240mApply - Integriere Optimierungen\033[0m"
    echo -e "\033[38;2;163;190;140m3)\033[0m \033[38;2;229;233;240mRestore - Backup wiederherstellen\033[0m"
    echo -e "\033[38;2;191;97;106m0)\033[0m \033[38;2;229;233;240mExit\033[0m"
    echo
    
    read -p "$(echo -e '\033[38;2;136;192;208mWÃ¤hle Option (0-3):\033[0m ') " choice
    
    case $choice in
        1) demo_optimized_themes ;;
        2) apply_optimized_theme_to_exapg ;;
        3) 
            if [ -f scripts/cli/terminal-ui.sh.optimized-backup ]; then
                cp scripts/cli/terminal-ui.sh.optimized-backup scripts/cli/terminal-ui.sh
                echo "âœ… Optimized backup restored!"
            else
                echo "âŒ No optimized backup found!"
            fi
            ;;
        0) echo -e "\033[38;2;163;190;140mâœ… Auf Wiedersehen!\033[0m"; exit 0 ;;
        *) echo -e "\033[38;2;191;97;106mâŒ UngÃ¼ltige Option\033[0m" ;;
    esac
}

# Export functions
export -f generate_optimized_nord_theme
export -f apply_contextual_colors
export -f apply_optimized_terminal_colors
export -f show_optimized_dialog

# Run main if executed directly
if [ "${BASH_SOURCE[0]}" = "${0}" ]; then
    main "$@"
fi 