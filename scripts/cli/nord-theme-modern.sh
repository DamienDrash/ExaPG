#!/bin/bash
# Modern Nord Theme f√ºr ExaPG - Optimierte Version mit semantischen Farben
# Behebt Monotonie und f√ºgt moderne UI-Hierarchie hinzu

# Moderne Nord Dark Theme Generator mit semantischen Farben
generate_modern_nord_dark_theme() {
    cat << 'EOF'
# ExaPG Modern Nord Dark Theme v3.0 - SEMANTIC COLORS
# Optimiert f√ºr moderne UI-Hierarchie und bessere UX
# https://nordtheme.com

# Dialog-Verhalten
aspect = 0
separate_widget = ""
tab_len = 0
visit_items = ON
use_shadow = ON
use_colors = ON

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# MODERNE NORD FARBSTRATEGIE - SEMANTISCHE HIERARCHIE
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# üîµ PRIM√ÑR: CYAN (Nord8) - Hauptaktionen, wichtige Navigation
# üî∑ SEKUND√ÑR: BLUE (Nord10) - Strukturelemente, Borders
# üü¢ ERFOLG: GREEN (Nord14) - Positive Aktionen, Best√§tigungen
# üü° WARNUNG: YELLOW (Nord13) - Aufmerksamkeit, Shortcuts
# üî¥ FEHLER: RED (Nord11) - Kritische Aktionen, Probleme
# üü£ INFO: MAGENTA (Nord15) - Spezielle Informationen, Hilfe
# ‚ö™ TEXT: WHITE (Nord5/6) - Standard Text, Lesbarkeit
# ‚ö´ HINTERGRUND: BLACK (Nord0/1) - Basis, Struktur
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# BASIS LAYOUT - Moderner Nord Look
screen_color = (WHITE,BLACK,OFF)
shadow_color = (BLACK,BLACK,ON)
dialog_color = (WHITE,BLACK,OFF)

# TITEL & BORDERS - Hierarchische Frost-Farben
title_color = (CYAN,BLACK,ON)           # üîµ Prim√§re Aufmerksamkeit
border_color = (BLUE,BLACK,ON)          # üî∑ Strukturelle Elemente
border2_color = (CYAN,BLACK,DIM)        # üîµ Sekund√§re Borders

# BUTTONS - Semantische Farbkodierung nach Funktion
button_active_color = (BLACK,GREEN,ON)      # üü¢ Erfolg-Gr√ºn f√ºr aktive Buttons
button_inactive_color = (BLUE,BLACK,OFF)    # üî∑ Ged√§mpftes Blau f√ºr inaktive
button_key_active_color = (BLACK,YELLOW,ON) # üü° Gelb f√ºr Keyboard-Shortcuts
button_key_inactive_color = (YELLOW,BLACK,DIM) # üü° Ged√§mpfte Shortcuts
button_label_active_color = (BLACK,GREEN,ON)    # üü¢ Konsistent mit Button
button_label_inactive_color = (WHITE,BLACK,OFF) # ‚ö™ Standard Text

# MENU SYSTEM - Moderne Hierarchie mit Farbdifferenzierung
menubox_color = (WHITE,BLACK,OFF)           # ‚ö™ Standard Hintergrund
menubox_border_color = (BLUE,BLACK,ON)      # üî∑ Strukturelle Begrenzung
menubox_border2_color = (CYAN,BLACK,ON)     # üîµ Akzent-Border
item_color = (WHITE,BLACK,OFF)              # ‚ö™ Standard Men√º-Items
item_selected_color = (BLACK,CYAN,ON)       # üîµ Prim√§re Selektion

# TAG SYSTEM - Aufmerksamkeits-Gelb f√ºr wichtige Elemente
tag_color = (YELLOW,BLACK,ON)               # üü° Auff√§llige Tags
tag_selected_color = (BLACK,YELLOW,ON)      # üü° Invertierte Selektion
tag_key_color = (YELLOW,BLACK,ON)           # üü° Konsistente Shortcuts
tag_key_selected_color = (BLACK,YELLOW,ON)  # üü° Aktive Shortcuts

# EINGABEFELDER - Moderne Input-√Ñsthetik
inputbox_color = (WHITE,BLACK,OFF)          # ‚ö™ Standard Input
inputbox_border_color = (CYAN,BLACK,ON)     # üîµ Prim√§re Input-Borders
inputbox_border2_color = (BLUE,BLACK,ON)    # üî∑ Sekund√§re Struktur
form_active_text_color = (BLACK,CYAN,ON)    # üîµ Aktive Eingabe
form_text_color = (WHITE,BLACK,OFF)         # ‚ö™ Standard Text
form_item_readonly_color = (BLUE,BLACK,DIM) # üî∑ Readonly-Felder

# CHECKBOXEN & AUSWAHL - Semantisches Gr√ºn f√ºr Best√§tigung
check_color = (WHITE,BLACK,OFF)             # ‚ö™ Unselected
check_selected_color = (BLACK,GREEN,ON)     # üü¢ Erfolg-Gr√ºn f√ºr Selected

# PROGRESS & GAUGE - Dynamische Fortschrittsanzeige
gauge_color = (BLACK,CYAN,ON)               # üîµ Prim√§rer Fortschritt

# SUCHFUNKTION - Spezialisierte Such-UI
searchbox_color = (WHITE,BLACK,OFF)         # ‚ö™ Such-Hintergrund
searchbox_title_color = (MAGENTA,BLACK,ON)  # üü£ Info-Magenta f√ºr Such-Titel
searchbox_border_color = (CYAN,BLACK,ON)    # üîµ Prim√§re Such-Border
searchbox_border2_color = (BLUE,BLACK,ON)   # üî∑ Sekund√§re Struktur

# NAVIGATION - Bewegungs-Gr√ºn f√ºr Richtungsanzeigen
position_indicator_color = (GREEN,BLACK,ON) # üü¢ Positions-Indikator
uarrow_color = (GREEN,BLACK,ON)             # üü¢ Aufw√§rts-Pfeil
darrow_color = (GREEN,BLACK,ON)             # üü¢ Abw√§rts-Pfeil

# HILFE & SEKUND√ÑRE ELEMENTE - Info-Magenta f√ºr Hilfe
itemhelp_color = (MAGENTA,BLACK,DIM)        # üü£ Hilfe-Text

# ERWEITERTE SEMANTISCHE ELEMENTE
# Kalender - Spezialisierte Farben f√ºr Zeitangaben
week_number_color = (MAGENTA,BLACK,ON)      # üü£ Wochen-Info
weekday_color = (BLUE,BLACK,ON)             # üî∑ Wochentage
day_color = (WHITE,BLACK,OFF)               # ‚ö™ Standard Tage
day_selected_color = (BLACK,CYAN,ON)        # üîµ Ausgew√§hlter Tag
month_color = (CYAN,BLACK,ON)               # üîµ Monat-Header
year_color = (YELLOW,BLACK,ON)              # üü° Jahr-Anzeige

# Text-Viewer - Optimiert f√ºr Lesbarkeit
textbox_color = (WHITE,BLACK,OFF)           # ‚ö™ Text-Hintergrund
textbox_border_color = (BLUE,BLACK,ON)      # üî∑ Text-Border
textbox_border2_color = (CYAN,BLACK,DIM)    # üîµ Sekund√§re Text-Border

# SPEZIELLE DIALOG-TYPEN - Semantische Farbkodierung
# Erfolgs-Dialoge
success_dialog_color = (WHITE,GREEN,OFF)    # üü¢ Erfolgs-Hintergrund
success_border_color = (GREEN,BLACK,ON)     # üü¢ Erfolgs-Border
success_title_color = (BLACK,GREEN,ON)      # üü¢ Erfolgs-Titel

# Warn-Dialoge
warning_dialog_color = (BLACK,YELLOW,OFF)   # üü° Warn-Hintergrund
warning_border_color = (YELLOW,BLACK,ON)    # üü° Warn-Border
warning_title_color = (BLACK,YELLOW,ON)     # üü° Warn-Titel

# Fehler-Dialoge
error_dialog_color = (WHITE,RED,OFF)        # üî¥ Fehler-Hintergrund
error_border_color = (RED,BLACK,ON)         # üî¥ Fehler-Border
error_title_color = (WHITE,RED,ON)          # üî¥ Fehler-Titel

# Info-Dialoge
info_dialog_color = (WHITE,MAGENTA,OFF)     # üü£ Info-Hintergrund
info_border_color = (MAGENTA,BLACK,ON)      # üü£ Info-Border
info_title_color = (WHITE,MAGENTA,ON)       # üü£ Info-Titel

EOF
}

# Erweiterte Dialog-Funktionen mit semantischen Farben
show_success_dialog() {
    local title="$1"
    local message="$2"
    
    # Tempor√§re DIALOGRC f√ºr Erfolgs-Dialog
    local temp_dialogrc="/tmp/success_dialogrc_$$"
    generate_modern_nord_dark_theme > "$temp_dialogrc"
    
    # Erfolgs-spezifische Anpassungen
    cat >> "$temp_dialogrc" << 'EOF'
# Erfolgs-Dialog Overrides
dialog_color = (WHITE,GREEN,OFF)
title_color = (BLACK,GREEN,ON)
border_color = (GREEN,BLACK,ON)
button_active_color = (BLACK,GREEN,ON)
EOF
    
    DIALOGRC="$temp_dialogrc" dialog \
        --colors \
        --backtitle "‚úÖ Success" \
        --title "[ $title ]" \
        --msgbox "$message" 8 50
    
    rm -f "$temp_dialogrc"
}

show_warning_dialog() {
    local title="$1"
    local message="$2"
    
    local temp_dialogrc="/tmp/warning_dialogrc_$$"
    generate_modern_nord_dark_theme > "$temp_dialogrc"
    
    cat >> "$temp_dialogrc" << 'EOF'
# Warn-Dialog Overrides
dialog_color = (BLACK,YELLOW,OFF)
title_color = (BLACK,YELLOW,ON)
border_color = (YELLOW,BLACK,ON)
button_active_color = (BLACK,YELLOW,ON)
EOF
    
    DIALOGRC="$temp_dialogrc" dialog \
        --colors \
        --backtitle "‚ö†Ô∏è Warning" \
        --title "[ $title ]" \
        --msgbox "$message" 8 50
    
    rm -f "$temp_dialogrc"
}

show_error_dialog() {
    local title="$1"
    local message="$2"
    
    local temp_dialogrc="/tmp/error_dialogrc_$$"
    generate_modern_nord_dark_theme > "$temp_dialogrc"
    
    cat >> "$temp_dialogrc" << 'EOF'
# Fehler-Dialog Overrides
dialog_color = (WHITE,RED,OFF)
title_color = (WHITE,RED,ON)
border_color = (RED,BLACK,ON)
button_active_color = (BLACK,RED,ON)
EOF
    
    DIALOGRC="$temp_dialogrc" dialog \
        --colors \
        --backtitle "‚ùå Error" \
        --title "[ $title ]" \
        --msgbox "$message" 8 50
    
    rm -f "$temp_dialogrc"
}

show_info_dialog() {
    local title="$1"
    local message="$2"
    
    local temp_dialogrc="/tmp/info_dialogrc_$$"
    generate_modern_nord_dark_theme > "$temp_dialogrc"
    
    cat >> "$temp_dialogrc" << 'EOF'
# Info-Dialog Overrides
dialog_color = (WHITE,MAGENTA,OFF)
title_color = (WHITE,MAGENTA,ON)
border_color = (MAGENTA,BLACK,ON)
button_active_color = (BLACK,MAGENTA,ON)
EOF
    
    DIALOGRC="$temp_dialogrc" dialog \
        --colors \
        --backtitle "‚ÑπÔ∏è Information" \
        --title "[ $title ]" \
        --msgbox "$message" 8 50
    
    rm -f "$temp_dialogrc"
}

# Demo der modernen semantischen Farben
demo_modern_nord_theme() {
    echo "üé® Modern Nord Theme Demo - Semantische Farben"
    echo "=============================================="
    
    # Terminal auf Nord umstellen
    printf '\033]11;#2E3440\007'  # Nord0 Background
    printf '\033]10;#D8DEE9\007'  # Nord4 Foreground
    
    # Standard Dialog mit modernem Theme
    export DIALOGRC="/tmp/modern_nord_dialogrc"
    generate_modern_nord_dark_theme > "$DIALOGRC"
    export DIALOGOPTS="--colors --no-shadow"
    
    # Demo-Sequenz
    dialog --colors \
           --backtitle "Modern Nord Theme Demo" \
           --title "üîµ Standard Dialog (Cyan)" \
           --msgbox "Dies ist ein Standard-Dialog mit Cyan-Akzenten.\n\nBeachten Sie:\n‚Ä¢ Cyan Borders (Prim√§r)\n‚Ä¢ Blue Struktur (Sekund√§r)\n‚Ä¢ Gr√ºne Buttons (Erfolg)" 12 50
    
    show_success_dialog "Erfolg Dialog" "‚úÖ Operation erfolgreich!\n\nGr√ºne Farben signalisieren Erfolg und positive Aktionen."
    
    show_warning_dialog "Warnung Dialog" "‚ö†Ô∏è Achtung erforderlich!\n\nGelbe Farben ziehen Aufmerksamkeit auf wichtige Informationen."
    
    show_error_dialog "Fehler Dialog" "‚ùå Ein Fehler ist aufgetreten!\n\nRote Farben signalisieren Probleme und kritische Situationen."
    
    show_info_dialog "Info Dialog" "‚ÑπÔ∏è Zus√§tzliche Information\n\nMagenta wird f√ºr spezielle Informationen und Hilfe verwendet."
    
    # Cleanup
    rm -f "$DIALOGRC"
    clear
    
    echo "‚úÖ Modern Nord Theme Demo abgeschlossen!"
    echo
    echo "Semantische Farbkodierung:"
    echo "üîµ CYAN - Prim√§re Aktionen, Navigation"
    echo "üî∑ BLUE - Strukturelemente, Borders"  
    echo "üü¢ GREEN - Erfolg, positive Aktionen"
    echo "üü° YELLOW - Warnungen, Aufmerksamkeit"
    echo "üî¥ RED - Fehler, kritische Aktionen"
    echo "üü£ MAGENTA - Info, Hilfe, Spezialfunktionen"
}

# Integration in ExaPG - SICHERE VERSION
apply_modern_nord_to_exapg() {
    echo "üîß Applying Modern Nord Theme to ExaPG..."
    
    # Backup der aktuellen terminal-ui.sh
    if [ ! -f scripts/cli/terminal-ui.sh.backup ]; then
        cp scripts/cli/terminal-ui.sh scripts/cli/terminal-ui.sh.backup
        echo "üìÅ Backup created: scripts/cli/terminal-ui.sh.backup"
    fi
    
    # Pr√ºfe ob die moderne Theme-Funktion bereits existiert
    if grep -q "generate_modern_nord_dark_theme" scripts/cli/terminal-ui.sh; then
        echo "‚úÖ Modern Nord Theme already integrated!"
        return 0
    fi
    
    # Sichere Integration: F√ºge die moderne Theme-Funktion am Ende hinzu
    echo "" >> scripts/cli/terminal-ui.sh
    echo "# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê" >> scripts/cli/terminal-ui.sh
    echo "# MODERN NORD THEME INTEGRATION - Added by nord-theme-modern.sh" >> scripts/cli/terminal-ui.sh
    echo "# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê" >> scripts/cli/terminal-ui.sh
    echo "" >> scripts/cli/terminal-ui.sh
    
    # Moderne Theme-Funktion hinzuf√ºgen
    cat >> scripts/cli/terminal-ui.sh << 'EOF'
# Modern Nord Theme Generator (injected by nord-theme-modern.sh)
generate_modern_nord_dark_theme() {
    cat << 'THEME_EOF'
# ExaPG Modern Nord Dark Theme v3.0 - SEMANTIC COLORS
# Optimiert f√ºr moderne UI-Hierarchie und bessere UX
# https://nordtheme.com

# Dialog-Verhalten
aspect = 0
separate_widget = ""
tab_len = 0
visit_items = ON
use_shadow = ON
use_colors = ON

# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# MODERNE NORD FARBSTRATEGIE - SEMANTISCHE HIERARCHIE
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
# üîµ PRIM√ÑR: CYAN (Nord8) - Hauptaktionen, wichtige Navigation
# üî∑ SEKUND√ÑR: BLUE (Nord10) - Strukturelemente, Borders
# üü¢ ERFOLG: GREEN (Nord14) - Positive Aktionen, Best√§tigungen
# üü° WARNUNG: YELLOW (Nord13) - Aufmerksamkeit, Shortcuts
# üî¥ FEHLER: RED (Nord11) - Kritische Aktionen, Probleme
# üü£ INFO: MAGENTA (Nord15) - Spezielle Informationen, Hilfe
# ‚ö™ TEXT: WHITE (Nord5/6) - Standard Text, Lesbarkeit
# ‚ö´ HINTERGRUND: BLACK (Nord0/1) - Basis, Struktur
# ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

# BASIS LAYOUT - Moderner Nord Look
screen_color = (WHITE,BLACK,OFF)
shadow_color = (BLACK,BLACK,ON)
dialog_color = (WHITE,BLACK,OFF)

# TITEL & BORDERS - Hierarchische Frost-Farben
title_color = (CYAN,BLACK,ON)           # üîµ Prim√§re Aufmerksamkeit
border_color = (BLUE,BLACK,ON)          # üî∑ Strukturelle Elemente
border2_color = (CYAN,BLACK,DIM)        # üîµ Sekund√§re Borders

# BUTTONS - Semantische Farbkodierung nach Funktion
button_active_color = (BLACK,GREEN,ON)      # üü¢ Erfolg-Gr√ºn f√ºr aktive Buttons
button_inactive_color = (BLUE,BLACK,OFF)    # üî∑ Ged√§mpftes Blau f√ºr inaktive
button_key_active_color = (BLACK,YELLOW,ON) # üü° Gelb f√ºr Keyboard-Shortcuts
button_key_inactive_color = (YELLOW,BLACK,DIM) # üü° Ged√§mpfte Shortcuts
button_label_active_color = (BLACK,GREEN,ON)    # üü¢ Konsistent mit Button
button_label_inactive_color = (WHITE,BLACK,OFF) # ‚ö™ Standard Text

# MENU SYSTEM - Moderne Hierarchie mit Farbdifferenzierung
menubox_color = (WHITE,BLACK,OFF)           # ‚ö™ Standard Hintergrund
menubox_border_color = (BLUE,BLACK,ON)      # üî∑ Strukturelle Begrenzung
menubox_border2_color = (CYAN,BLACK,ON)     # üîµ Akzent-Border
item_color = (WHITE,BLACK,OFF)              # ‚ö™ Standard Men√º-Items
item_selected_color = (BLACK,CYAN,ON)       # üîµ Prim√§re Selektion

# TAG SYSTEM - Aufmerksamkeits-Gelb f√ºr wichtige Elemente
tag_color = (YELLOW,BLACK,ON)               # üü° Auff√§llige Tags
tag_selected_color = (BLACK,YELLOW,ON)      # üü° Invertierte Selektion
tag_key_color = (YELLOW,BLACK,ON)           # üü° Konsistente Shortcuts
tag_key_selected_color = (BLACK,YELLOW,ON)  # üü° Aktive Shortcuts

# EINGABEFELDER - Moderne Input-√Ñsthetik
inputbox_color = (WHITE,BLACK,OFF)          # ‚ö™ Standard Input
inputbox_border_color = (CYAN,BLACK,ON)     # üîµ Prim√§re Input-Borders
inputbox_border2_color = (BLUE,BLACK,ON)    # üî∑ Sekund√§re Struktur
form_active_text_color = (BLACK,CYAN,ON)    # üîµ Aktive Eingabe
form_text_color = (WHITE,BLACK,OFF)         # ‚ö™ Standard Text
form_item_readonly_color = (BLUE,BLACK,DIM) # üî∑ Readonly-Felder

# CHECKBOXEN & AUSWAHL - Semantisches Gr√ºn f√ºr Best√§tigung
check_color = (WHITE,BLACK,OFF)             # ‚ö™ Unselected
check_selected_color = (BLACK,GREEN,ON)     # üü¢ Erfolg-Gr√ºn f√ºr Selected

# PROGRESS & GAUGE - Dynamische Fortschrittsanzeige
gauge_color = (BLACK,CYAN,ON)               # üîµ Prim√§rer Fortschritt

# SUCHFUNKTION - Spezialisierte Such-UI
searchbox_color = (WHITE,BLACK,OFF)         # ‚ö™ Such-Hintergrund
searchbox_title_color = (MAGENTA,BLACK,ON)  # üü£ Info-Magenta f√ºr Such-Titel
searchbox_border_color = (CYAN,BLACK,ON)    # üîµ Prim√§re Such-Border
searchbox_border2_color = (BLUE,BLACK,ON)   # üî∑ Sekund√§re Struktur

# NAVIGATION - Bewegungs-Gr√ºn f√ºr Richtungsanzeigen
position_indicator_color = (GREEN,BLACK,ON) # üü¢ Positions-Indikator
uarrow_color = (GREEN,BLACK,ON)             # üü¢ Aufw√§rts-Pfeil
darrow_color = (GREEN,BLACK,ON)             # üü¢ Abw√§rts-Pfeil

# HILFE & SEKUND√ÑRE ELEMENTE - Info-Magenta f√ºr Hilfe
itemhelp_color = (MAGENTA,BLACK,DIM)        # üü£ Hilfe-Text

# ERWEITERTE SEMANTISCHE ELEMENTE
# Kalender - Spezialisierte Farben f√ºr Zeitangaben
week_number_color = (MAGENTA,BLACK,ON)      # üü£ Wochen-Info
weekday_color = (BLUE,BLACK,ON)             # üî∑ Wochentage
day_color = (WHITE,BLACK,OFF)               # ‚ö™ Standard Tage
day_selected_color = (BLACK,CYAN,ON)        # üîµ Ausgew√§hlter Tag
month_color = (CYAN,BLACK,ON)               # üîµ Monat-Header
year_color = (YELLOW,BLACK,ON)              # üü° Jahr-Anzeige

# Text-Viewer - Optimiert f√ºr Lesbarkeit
textbox_color = (WHITE,BLACK,OFF)           # ‚ö™ Text-Hintergrund
textbox_border_color = (BLUE,BLACK,ON)      # üî∑ Text-Border
textbox_border2_color = (CYAN,BLACK,DIM)    # üîµ Sekund√§re Text-Border

# SPEZIELLE DIALOG-TYPEN - Semantische Farbkodierung
# Erfolgs-Dialoge
success_dialog_color = (WHITE,GREEN,OFF)    # üü¢ Erfolgs-Hintergrund
success_border_color = (GREEN,BLACK,ON)     # üü¢ Erfolgs-Border
success_title_color = (BLACK,GREEN,ON)      # üü¢ Erfolgs-Titel

# Warn-Dialoge
warning_dialog_color = (BLACK,YELLOW,OFF)   # üü° Warn-Hintergrund
warning_border_color = (YELLOW,BLACK,ON)    # üü° Warn-Border
warning_title_color = (BLACK,YELLOW,ON)     # üü° Warn-Titel

# Fehler-Dialoge
error_dialog_color = (WHITE,RED,OFF)        # üî¥ Fehler-Hintergrund
error_border_color = (RED,BLACK,ON)         # üî¥ Fehler-Border
error_title_color = (WHITE,RED,ON)          # üî¥ Fehler-Titel

# Info-Dialoge
info_dialog_color = (WHITE,MAGENTA,OFF)     # üü£ Info-Hintergrund
info_border_color = (MAGENTA,BLACK,ON)      # üü£ Info-Border
info_title_color = (WHITE,MAGENTA,ON)       # üü£ Info-Titel

THEME_EOF
}
EOF
    
    # Jetzt die bestehende generate_nord_dark_theme Funktion modifizieren
    # Sichere Methode: Erstelle eine tempor√§re Datei
    local temp_file="/tmp/terminal_ui_modified_$$"
    
    # Kopiere alles bis zur generate_nord_dark_theme Funktion
    awk '
    /^# Nord Dark Theme Generator - MODERN OPTIMIZED$/ { 
        print "# Nord Dark Theme Generator - MODERN OPTIMIZED"
        print "generate_nord_dark_theme() {"
        print "    generate_modern_nord_dark_theme"
        print "}"
        # √úberspringe die alte Funktion bis zur n√§chsten Funktion
        while (getline > 0 && !/^}$/) { }
        next
    }
    /^generate_nord_dark_theme\(\) \{$/ {
        print "# Nord Dark Theme Generator - MODERN OPTIMIZED"
        print "generate_nord_dark_theme() {"
        print "    generate_modern_nord_dark_theme"
        print "}"
        # √úberspringe die alte Funktion bis zur schlie√üenden Klammer
        while (getline > 0 && !/^}$/) { }
        next
    }
    { print }
    ' scripts/cli/terminal-ui.sh > "$temp_file"
    
    # Ersetze die Originaldatei
    mv "$temp_file" scripts/cli/terminal-ui.sh
    chmod +x scripts/cli/terminal-ui.sh
    
    echo "‚úÖ Modern Nord Theme successfully integrated!"
    echo "   Original backup: scripts/cli/terminal-ui.sh.backup"
    echo "   Integration method: Safe append + function redirect"
    echo ""
    echo "üé® The modern theme is now active with:"
    echo "   üîµ CYAN - Primary actions, navigation"
    echo "   üî∑ BLUE - Structural elements, borders"  
    echo "   üü¢ GREEN - Success, positive actions"
    echo "   üü° YELLOW - Warnings, attention"
    echo "   üî¥ RED - Errors, critical actions"
    echo "   üü£ MAGENTA - Info, help, special functions"
}

# Hauptmen√º
main() {
    clear
    echo -e "\033[38;2;136;192;208m‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó\033[0m"
    echo -e "\033[38;2;136;192;208m‚ïë\033[0m                                                              \033[38;2;136;192;208m‚ïë\033[0m"
    echo -e "\033[38;2;136;192;208m‚ïë\033[0m  \033[38;2;235;203;139müé® Modern Nord Theme f√ºr ExaPG\033[0m                          \033[38;2;136;192;208m‚ïë\033[0m"
    echo -e "\033[38;2;136;192;208m‚ïë\033[0m  \033[38;2;229;233;240mSemantische Farben & moderne UI-Hierarchie\033[0m              \033[38;2;136;192;208m‚ïë\033[0m"
    echo -e "\033[38;2;136;192;208m‚ïë\033[0m                                                              \033[38;2;136;192;208m‚ïë\033[0m"
    echo -e "\033[38;2;136;192;208m‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù\033[0m"
    echo
    echo -e "\033[38;2;163;190;140m1)\033[0m \033[38;2;229;233;240mDemo - Zeige semantische Farben\033[0m"
    echo -e "\033[38;2;163;190;140m2)\033[0m \033[38;2;229;233;240mApply - Integriere in ExaPG\033[0m"
    echo -e "\033[38;2;163;190;140m3)\033[0m \033[38;2;229;233;240mRestore - Backup wiederherstellen\033[0m"
    echo -e "\033[38;2;191;97;106m0)\033[0m \033[38;2;229;233;240mExit\033[0m"
    echo
    
    read -p "$(echo -e '\033[38;2;136;192;208mW√§hle Option (0-3):\033[0m ') " choice
    
    case $choice in
        1) demo_modern_nord_theme ;;
        2) apply_modern_nord_to_exapg ;;
        3) 
            if [ -f scripts/cli/terminal-ui.sh.backup ]; then
                cp scripts/cli/terminal-ui.sh.backup scripts/cli/terminal-ui.sh
                echo "‚úÖ Backup restored!"
            else
                echo "‚ùå No backup found!"
            fi
            ;;
        0) echo -e "\033[38;2;163;190;140m‚úÖ Auf Wiedersehen!\033[0m"; exit 0 ;;
        *) echo -e "\033[38;2;191;97;106m‚ùå Ung√ºltige Option\033[0m" ;;
    esac
}

# Export functions
export -f generate_modern_nord_dark_theme
export -f show_success_dialog
export -f show_warning_dialog
export -f show_error_dialog
export -f show_info_dialog

# Run main if executed directly
if [ "${BASH_SOURCE[0]}" = "${0}" ]; then
    main "$@"
fi 